{% extends "base.html" %}

{% block content %}
  <h2>ğŸ“‹ ç™»éŒ²æ¸ˆã¿è»Šä¸¡ä¸€è¦§</h2>

  <form method="get">
    <input type="text" name="keyword" placeholder="è»Šåãƒ»å‹å¼ãƒ»å…¥åº«ç•ªå·" value="{{ keyword }}">
    <button type="submit">æ¤œç´¢</button>
  </form>

  <table>
    <tr>
      {# ğŸ” ä¸¦ã³æ›¿ãˆå¯èƒ½ãªã‚«ãƒ©ãƒ ã«ã¯ãƒªãƒ³ã‚¯ + â–²â–¼ #}
      {% macro sort_link(label, field) %}
        <a href="{{ url_for('routes.list_vehicles', keyword=keyword, sort=field, order='asc' if sort_key != field or sort_order == 'desc' else 'desc') }}">
          {{ label }}
          {% if sort_key == field %}
            {{ 'â–²' if sort_order == 'asc' else 'â–¼' }}
          {% endif %}
        </a>
      {% endmacro %}

      <th>{{ sort_link('ID', 'id') }}</th>
      <th>{{ sort_link('å…¥åº«ç•ªå·', 'intake_number') }}</th>
      <th>{{ sort_link('è‡ªç¤¾ç®¡ç†ç•ªå·', 'internal_code') }}</th>
      <th>ãƒ¡ãƒ¼ã‚«ãƒ¼</th>
      <th>è»Šå</th>
      <th>èªå®šå‹å¼</th>
      <th>å¹´å¼</th>
      <th>è»Šå°ç•ªå·</th>
      <th>è»Šè‰²</th>
      <th>{{ sort_link('å¼•å–å®Œäº†æ—¥', 'pickup_date') }}</th>
      <th>{{ sort_link('ä¾é ¼å…ƒ', 'client') }}</th>
      <th>è¦‹ç©é‡‘é¡</th>
      <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
      <th>çŠ¶æ…‹</th>
    </tr>

    {% for v in vehicles %}
    <tr>
      <td>{{ v.id }}</td>
      <td>{{ v.intake_number }}</td>
      <td>{{ v.internal_code }}</td>
      <td>{{ v.manufacturer.name if v.manufacturer else 'ä¸æ˜' }}</td>
      <td>{{ v.car_name }}</td>
      <td>{{ v.model_code }}</td>
      <td>{{ v.year }}</td>
      <td>{{ v.vin }}</td>
      <td>{{ v.color }}</td>
      <td>{{ v.pickup_date }}</td>
      <td>{{ v.client }}</td>
      <td>{{ v.estimate_price }}</td>
      <td>{{ v.status }}</td>
      <td>{{ v.condition }}</td>
    </tr>
    {% endfor %}
  </table>
{% endblock %}
